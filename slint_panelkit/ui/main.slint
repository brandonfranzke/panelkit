import { Button } from "components/button.slint";
import { ScrollView } from "components/scroll_view.slint";

export component MainWindow inherits Window {
    in-out property <string> window-title: "PanelKit";
    in-out property <length> window-width: 640px;
    in-out property <length> window-height: 480px;
    in-out property <bool> debug-mode: false;
    
    in-out property <color> page-background: #f0f0f0;
    in-out property <string> current-time: "00:00:00";
    in-out property <string> current-date: "2023-Jan-01";
    in-out property <bool> date-inverted: false;
    
    in-out property <length> scroll-position-y: 0px;
    private property <bool> is-scrolling: false;
    
    callback blue-button-clicked();
    callback random-button-clicked();
    callback date-button-clicked();
    callback log-scroll-position(length, length);
    
    title: window-title;
    width: window-width;
    height: window-height;
    background: page-background;
    
    Rectangle {
        visible: root.debug-mode;
        x: 10px;
        y: 10px;
        width: 200px;
        height: 60px;
        background: #00000080;
        Text {
            color: white;
            text: "Scrolling: " + (root.is-scrolling ? "Yes" : "No") + 
                  "\nScroll Y: " + Math.round(root.scroll-position-y / 1px) + "px";
            font-size: 14px;
            padding: 5px;
        }
    }
    
    ScrollView {
        viewport-width: root.window-width;
        viewport-height: root.window-height;
        content-width: root.window-width;
        content-height: 2000px; // Fixed height large enough for all buttons
        vertical-only: true;
        interactive: true;
        
        scroll-y <=> root.scroll-position-y;
        
        scroll-changed(x, y) => {
            root.is-scrolling = true;
            root.log-scroll-position(x, y);
        }
        
        VerticalLayout {
            width: 100%;
            height: 100%;
            spacing: 20px;
            padding: 20px;
            alignment: center;
            
            Button {
                text: "Blue";
                background: #2980b9;
                height: root.window-height * 2/3; 
                width: root.window-width / 2;
                
                clicked => {
                    root.blue-button-clicked();
                }
            }
            
            Button {
                text: "Random";
                background: #16a085;
                height: root.window-height * 2/3;
                width: root.window-width / 2;
                
                clicked => {
                    root.random-button-clicked();
                }
            }
            
            Button {
                text: root.current-time + "\n" + root.current-date;
                background: #8e44ad;
                height: root.window-height * 2/3;
                width: root.window-width / 2;
                inverted: root.date-inverted;
                
                clicked => {
                    root.date-button-clicked();
                }
            }
            
            for color[i] in [#e74c3c, #f39c12, #27ae60, #2980b9, #8e44ad, #2c3e50] : Button {
                text: "Button #" + (i + 4);
                background: color;
                height: root.window-height * 2/3;
                width: root.window-width / 2;
            }
        }
    }
}